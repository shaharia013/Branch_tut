This is code of version 1 of branch master